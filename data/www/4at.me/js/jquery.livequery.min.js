/*! Copyright (c) 2008 Brandon Aaron (http://brandonaaron.net)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.0.3
 * Requires jQuery 1.1.3+
 * Docs: http://docs.jquery.com/Plugins/livequery
 */
(function(d){d.extend(d.fn,{livequery:function(b,h,i){var j=this,a;if(d.isFunction(b)){i=h,h=b,b=undefined}d.each(d.livequery.queries,function(f,e){if(j.selector==e.selector&&j.context==e.context&&b==e.type&&(!h||h.$lqguid==e.fn.$lqguid)&&(!i||i.$lqguid==e.fn2.$lqguid)){return(a=e)&&false}});a=a||new d.livequery(this.selector,this.context,b,h,i);a.stopped=false;a.run();return this},expire:function(a,b,g){var h=this;if(d.isFunction(a)){g=b,b=a,a=undefined}d.each(d.livequery.queries,function(f,e){if(h.selector==e.selector&&h.context==e.context&&(!a||a==e.type)&&(!b||b.$lqguid==e.fn.$lqguid)&&(!g||g.$lqguid==e.fn2.$lqguid)&&!this.stopped){d.livequery.stop(e.id)}});return this}});d.livequery=function(j,h,a,b,i){this.selector=j;this.context=h||document;this.type=a;this.fn=b;this.fn2=i;this.elements=[];this.stopped=false;this.id=d.livequery.queries.push(this)-1;b.$lqguid=b.$lqguid||d.livequery.guid++;if(i){i.$lqguid=i.$lqguid||d.livequery.guid++}return this};d.livequery.prototype={stop:function(){var a=this;if(this.type){this.elements.unbind(this.type,this.fn)}else{if(this.fn2){this.elements.each(function(f,b){a.fn2.apply(b)})}}this.elements=[];this.stopped=true},run:function(){if(this.stopped){return}var b=this;var a=this.elements,g=d(this.selector,this.context),h=g.not(a);this.elements=g;if(this.type){h.bind(this.type,this.fn);if(a.length>0){d.each(a,function(f,e){if(d.inArray(e,g)<0){d.event.remove(e,b.type,b.fn)}})}}else{h.each(function(){b.fn.apply(this)});if(this.fn2&&a.length>0){d.each(a,function(f,e){if(d.inArray(e,g)<0){b.fn2.apply(e)}})}}}};d.extend(d.livequery,{guid:0,queries:[],queue:[],running:false,timeout:null,checkQueue:function(){if(d.livequery.running&&d.livequery.queue.length){var a=d.livequery.queue.length;while(a--){d.livequery.queries[d.livequery.queue.shift()].run()}}},pause:function(){d.livequery.running=false},play:function(){d.livequery.running=true;d.livequery.run()},registerPlugin:function(){d.each(arguments,function(b,a){if(!d.fn[a]){return}var f=d.fn[a];d.fn[a]=function(){var e=f.apply(this,arguments);d.livequery.run();return e}})},run:function(a){if(a!=undefined){if(d.inArray(a,d.livequery.queue)<0){d.livequery.queue.push(a)}}else{d.each(d.livequery.queries,function(b){if(d.inArray(b,d.livequery.queue)<0){d.livequery.queue.push(b)}})}if(d.livequery.timeout){clearTimeout(d.livequery.timeout)}d.livequery.timeout=setTimeout(d.livequery.checkQueue,20)},stop:function(a){if(a!=undefined){d.livequery.queries[a].stop()}else{d.each(d.livequery.queries,function(b){d.livequery.queries[b].stop()})}}});d.livequery.registerPlugin("append","prepend","after","before","wrap","attr","removeAttr","addClass","removeClass","toggleClass","empty","remove");d(function(){d.livequery.play()});var c=d.prototype.init;d.prototype.init=function(g,a){var b=c.apply(this,arguments);if(g&&g.selector){b.context=g.context,b.selector=g.selector}if(typeof g=="string"){b.context=a||document,b.selector=g}return b};d.prototype.init.prototype=d.prototype})(jQuery);